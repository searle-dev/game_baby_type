<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Baby Type!</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      overflow: hidden;
      user-select: none;
      -webkit-user-select: none;
    }

    #game {
      width: 100vw;
      height: 100vh;
      background: linear-gradient(135deg, #FFF8F0, #F0E6FF);
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    #card-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    #letter-card {
      min-width: 280px;
      min-height: 200px;
      background: rgba(255, 255, 255, 0.7);
      border-radius: 2rem;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      opacity: 0;
    }

    #letter {
      font-size: 20vw;
      font-weight: bold;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      line-height: 1.1;
    }

    #emoji-word {
      font-size: 4vw;
      margin-top: 1rem;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
    }

    #particles {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
    }

    #challenge-overlay {
      position: fixed;
      top: 10vh;
      left: 50%;
      transform: translateX(-50%);
      font-size: 3vw;
      color: #887050;
      opacity: 0;
      transition: opacity 0.5s;
      pointer-events: none;
      text-align: center;
      z-index: 10;
    }

    #parent-btn {
      position: fixed;
      top: 1rem;
      right: 1rem;
      font-size: 1.5rem;
      color: #ccc;
      opacity: 0.3;
      cursor: pointer;
      z-index: 20;
      user-select: none;
      -webkit-user-select: none;
    }

    #parent-panel {
      position: fixed;
      top: 0;
      right: 0;
      width: 250px;
      height: 100vh;
      background: white;
      box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
      padding: 2rem;
      display: none;
      z-index: 30;
    }

    #parent-panel label {
      display: block;
      margin-bottom: 1rem;
    }

    #prompt {
      position: absolute;
      bottom: 10vh;
      left: 50%;
      transform: translateX(-50%);
      font-size: 2vw;
      color: #ccc;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
    }

    @keyframes bounceIn {
      0% { transform: scale(0.3); opacity: 0; }
      50% { transform: scale(1.08); opacity: 1; }
      70% { transform: scale(0.95); }
      100% { transform: scale(1); opacity: 1; }
    }

    #letter-card.show {
      animation: bounceIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    }

    @keyframes particleFly {
      0% { transform: translate(0, 0) scale(1); opacity: 1; }
      100% { transform: translate(var(--dx), var(--dy)) scale(0); opacity: 0; }
    }

    .particle {
      position: absolute;
      border-radius: 50%;
      pointer-events: none;
      animation: particleFly 0.8s ease-out forwards;
    }

    @keyframes floatUp {
      0% { transform: translateY(0) scale(1); opacity: 1; }
      100% { transform: translateY(-200px) scale(0.5); opacity: 0; }
    }

    .surprise-bubble {
      position: absolute;
      font-size: 3rem;
      pointer-events: none;
      animation: floatUp 1.2s ease-out forwards;
    }

    @media (max-width: 768px) {
      #letter {
        font-size: 30vw;
      }

      #emoji-word {
        font-size: 6vw;
      }

      #prompt {
        font-size: 4vw;
      }
    }
  </style>
</head>
<body>
  <div id="game">
    <div id="card-container">
      <div id="letter-card">
        <div id="letter"></div>
        <div id="emoji-word"></div>
      </div>
    </div>
    <div id="particles"></div>
    <div id="challenge-overlay"></div>
    <div id="parent-btn">&#9881;</div>
    <div id="parent-panel">
      <h3>Settings</h3>
      <label><input type="checkbox" id="mute-toggle"> Mute</label>
      <label><input type="checkbox" id="challenge-toggle" checked> Challenge Mode</label>
    </div>
    <div id="prompt">Press any key!</div>
  </div>
  <script>
    const LETTER_MAP = {
      a: { emoji: 'ðŸŽ', word: 'Apple', color: '#E07070' },
      b: { emoji: 'ðŸ»', word: 'Bear', color: '#C0956C' },
      c: { emoji: 'ðŸ±', word: 'Cat', color: '#E8A060' },
      d: { emoji: 'ðŸ¶', word: 'Dog', color: '#C09860' },
      e: { emoji: 'ðŸ˜', word: 'Elephant', color: '#A0A0B0' },
      f: { emoji: 'ðŸŸ', word: 'Fish', color: '#70A0D0' },
      g: { emoji: 'ðŸ‡', word: 'Grape', color: '#9070B0' },
      h: { emoji: 'ðŸ´', word: 'Horse', color: '#B08860' },
      i: { emoji: 'ðŸ¦', word: 'Ice Cream', color: '#E0B0C0' },
      j: { emoji: 'ðŸª¼', word: 'Jellyfish', color: '#B070D0' },
      k: { emoji: 'ðŸª', word: 'Kite', color: '#70B0D0' },
      l: { emoji: 'ðŸ¦', word: 'Lion', color: '#D0A040' },
      m: { emoji: 'ðŸŒ™', word: 'Moon', color: '#E0D070' },
      n: { emoji: 'ðŸ¥œ', word: 'Nut', color: '#C0A070' },
      o: { emoji: 'ðŸ™', word: 'Octopus', color: '#D07090' },
      p: { emoji: 'ðŸ§', word: 'Penguin', color: '#606080' },
      q: { emoji: 'ðŸ‘‘', word: 'Queen', color: '#D0B040' },
      r: { emoji: 'ðŸŒˆ', word: 'Rainbow', color: '#D08080' },
      s: { emoji: 'â˜€ï¸', word: 'Sun', color: '#E0C040' },
      t: { emoji: 'ðŸ¯', word: 'Tiger', color: '#E0A040' },
      u: { emoji: 'â˜‚ï¸', word: 'Umbrella', color: '#7080C0' },
      v: { emoji: 'ðŸŽ»', word: 'Violin', color: '#A07050' },
      w: { emoji: 'ðŸ‹', word: 'Whale', color: '#5090B0' },
      x: { emoji: 'ðŸŽµ', word: 'Xylophone', color: '#C07090' },
      y: { emoji: 'ðŸ§¶', word: 'Yarn', color: '#D08090' },
      z: { emoji: 'ðŸ¦“', word: 'Zebra', color: '#707070' }
    };

    const NUMBER_EMOJI = 'â­';
    const SURPRISE_EMOJIS = ['ðŸŽˆ', 'â­', 'ðŸŽ‰', 'âœ¨', 'ðŸ¦‹', 'ðŸŒ¸', 'ðŸ’«', 'ðŸŽµ', 'ðŸ«§', 'ðŸŒŸ'];

    let audioCtx = null;
    let isMuted = false;

    let lastKeyTime = 0;
    const THROTTLE_MS = 200;

    document.addEventListener('keydown', (e) => {
      e.preventDefault();
      const now = Date.now();
      if (now - lastKeyTime < THROTTLE_MS) return;
      lastKeyTime = now;

      const key = e.key.toLowerCase();

      if (LETTER_MAP[key]) {
        showLetterCard(key);
      } else if (key >= '0' && key <= '9') {
        showNumberCard(key);
      } else {
        showSurprise();
      }
    });

    const letterEl = document.getElementById('letter');
    const emojiWordEl = document.getElementById('emoji-word');
    const letterCard = document.getElementById('letter-card');
    const promptEl = document.getElementById('prompt');
    const particlesEl = document.getElementById('particles');

    function spawnParticles(count, x, y) {
      for (let i = 0; i < count; i++) {
        const p = document.createElement('div');
        p.className = 'particle';
        const size = Math.random() * 12 + 6;
        const angle = (Math.PI * 2 * i) / count + (Math.random() - 0.5) * 0.5;
        const dist = Math.random() * 120 + 60;
        const dx = Math.cos(angle) * dist;
        const dy = Math.sin(angle) * dist;
        const hue = Math.random() * 360;
        p.style.cssText = `
          width: ${size}px; height: ${size}px;
          left: ${x}px; top: ${y}px;
          background: hsl(${hue}, 70%, 70%);
          --dx: ${dx}px; --dy: ${dy}px;
        `;
        particlesEl.appendChild(p);
        p.addEventListener('animationend', () => p.remove());
      }
    }

    function emitCardParticles(count = 12) {
      requestAnimationFrame(() => {
        const rect = letterCard.getBoundingClientRect();
        const cx = rect.left + rect.width / 2;
        const cy = rect.top + rect.height / 2;
        spawnParticles(count, cx, cy);
      });
    }

    function getAudioCtx() {
      if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      return audioCtx;
    }

    function playDing(freq = 800) {
      if (isMuted) return;
      try {
        const ctx = getAudioCtx();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.type = 'sine';
        osc.frequency.value = freq;
        gain.gain.setValueAtTime(0.15, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.4);
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.start();
        osc.stop(ctx.currentTime + 0.4);
      } catch (e) { /* silent fail */ }
    }

    function playRisingScale() {
      if (isMuted) return;
      try {
        const ctx = getAudioCtx();
        const notes = [523, 659, 784];
        notes.forEach((freq, i) => {
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.type = 'sine';
          osc.frequency.value = freq;
          gain.gain.setValueAtTime(0.1, ctx.currentTime + i * 0.12);
          gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + i * 0.12 + 0.3);
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.start(ctx.currentTime + i * 0.12);
          osc.stop(ctx.currentTime + i * 0.12 + 0.3);
        });
      } catch (e) { /* silent fail */ }
    }

    function playCheer() {
      if (isMuted) return;
      try {
        const ctx = getAudioCtx();
        const chord = [523, 659, 784, 1047];
        chord.forEach((freq) => {
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.type = 'sine';
          osc.frequency.value = freq;
          gain.gain.setValueAtTime(0.08, ctx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.8);
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.start();
          osc.stop(ctx.currentTime + 0.8);
        });
      } catch (e) { /* silent fail */ }
    }

    function speak(text) {
      if (isMuted) return;
      try {
        const u = new SpeechSynthesisUtterance(text);
        u.rate = 0.8;
        u.pitch = 1.2;
        u.volume = 0.7;
        speechSynthesis.cancel();
        speechSynthesis.speak(u);
      } catch (e) { /* silent fail */ }
    }

    function showLetterCard(key) {
      const data = LETTER_MAP[key];
      letterEl.textContent = key.toUpperCase();
      letterEl.style.color = data.color;
      emojiWordEl.textContent = `${data.emoji} ${data.word}`;
      triggerCardAnimation();
      emitCardParticles();
      playDing(600 + Math.random() * 400);
      speak(key.toUpperCase() + ', ' + data.word);
      promptEl.style.display = 'none';
    }

    function showNumberCard(key) {
      const num = parseInt(key);
      letterEl.textContent = key;
      letterEl.style.color = '#E0C040';
      emojiWordEl.textContent = num === 0 ? 'ðŸŒŸ' : NUMBER_EMOJI.repeat(num);
      triggerCardAnimation();
      emitCardParticles();
      playDing(700);
      speak(key);
      promptEl.style.display = 'none';
    }

    function showSurprise() {
      // Hide the letter card
      letterCard.classList.remove('show');
      letterEl.textContent = '';
      emojiWordEl.textContent = '';

      // Spawn 5-8 random emoji bubbles at random positions
      const count = Math.floor(Math.random() * 4) + 5;
      for (let i = 0; i < count; i++) {
        const bubble = document.createElement('div');
        bubble.className = 'surprise-bubble';
        bubble.textContent = SURPRISE_EMOJIS[Math.floor(Math.random() * SURPRISE_EMOJIS.length)];
        bubble.style.left = Math.random() * 80 + 10 + 'vw';
        bubble.style.top = Math.random() * 60 + 20 + 'vh';
        particlesEl.appendChild(bubble);
        bubble.addEventListener('animationend', () => bubble.remove());
      }

      playRisingScale();

      promptEl.style.display = 'none';
    }

    function triggerCardAnimation() {
      letterCard.classList.remove('show');
      void letterCard.offsetWidth; // Force reflow
      letterCard.classList.add('show');
    }
  </script>
</body>
</html>
